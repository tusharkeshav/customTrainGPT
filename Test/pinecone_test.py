import os

from pinecone import Pinecone
import constants
from datetime import datetime
import openai
from langchain_openai import OpenAIEmbeddings

os.environ["OPENAI_API_KEY"] = constants.OPENAI_APIKEY


pc = Pinecone(api_key=constants.PINECONE_APIKEY)
m_time = datetime.now()
index = pc.Index("first-book-index", host=constants.PINECONE_HOST)
f_time = datetime.now()
data = index.query(top_k=4, include_metadata=True,
                   vector=[-0.0279256795, -0.000111784306, -0.0154474312, -0.0246493388, -0.0227680039, 0.0247773211,
                           -0.000630311493, -0.0189029463, 0.000373347575, -0.0268506296, 0.00805646926, 0.0157801844,
                           0.00182054436, 0.00829963479, -0.0292822886, -0.00190213299, 0.018135054, -0.00192452979,
                           -0.00598316, -0.00300917751, -0.0142955929, 0.005100084, -0.00342991855, -0.0206690989,
                           0.00132701371, -0.00195012626, 0.0163817, -0.0243037883, 0.00599595811, -0.0115759745,
                           -0.0060279537, 0.00177735044, 0.00227008131, -0.0404423214, 0.000483132171, 0.0016973617,
                           0.0118319392, -0.00219329214, 0.00856839679, -0.0200291872, -0.0114607913, -0.0085364012,
                           -0.00129181868, 0.00343631743, -0.0189797357, 0.00295478525, -0.0092595, -0.0232415367,
                           -0.0146411443, 0.00721178763, 0.0206435025, -0.0173671618, -0.0180582646, 0.00119663205,
                           -0.00654948037, 0.0215649717, -0.0108080823, -0.00321234902, -0.0115887728, -0.0105073247,
                           -0.0118895303, 0.0120815039, -0.0277465042, 0.0261467285, 0.000473533524, -0.0190821216,
                           0.00310356426, 0.0023980632, 0.0107888849, -0.00497850124, 0.032916978, 0.0031163625,
                           0.00148619129, -0.00429699663, 0.0143979788, 0.0113200108, 0.0151018798, 0.020400336,
                           -0.01446197, -0.0242909901, 0.0244061742, -0.0321234912, 0.00541364, 0.0261979215,
                           0.0235742908, 0.00560561288, -0.0140908221, 0.0136812795, -0.0240862183, 0.0106992982,
                           0.00462015113, 0.0220513046, 0.000793088635, 0.0268250331, -0.0235358961, 0.0108144814,
                           -0.0132589387, 0.0238814466, 0.00993780512, -0.0350926742, 0.0078516975, 0.00393544743,
                           -0.0163561031, -0.0077173165, -0.0173671618, -0.00552562438, -0.002550042, -0.00290999142,
                           0.0129389837, -0.00508088665, -0.00803087279, 0.0352718495, 0.0214497875, -0.0325074345,
                           -0.00503609283, -0.011492786, 0.00145899516, -0.00357709778, -0.0164072961, -0.0164200943,
                           0.000512728, -0.000698701886, 0.0186085869, -0.00100145943, 0.024124613, 0.0189029463,
                           -0.0240478236, -0.0192484967, -0.00393544743, -0.00528245838, 0.0354254246, -0.0156905968,
                           0.0164968837, 0.0302037597, -0.0227808021, 0.029359078, -0.0248285141, -0.00011928325,
                           -0.000871077704, -0.0372683667, -0.0145771531, 0.0247645229, 0.0184678063, 0.00489851227,
                           0.0111856293, 0.00927869696, 0.026927419, -0.0178023, -0.00446017366, -0.00296278391,
                           0.00794128515, -0.00430019619, 0.0133997183, -0.0166248661, 0.0145259602, 0.0381642431,
                           -0.0238302536, 0.0264410879, 0.0148843098, -0.0105713159, 0.011064047, 0.00813325774,
                           0.0188773498, -0.0306133013, 0.00548722968, 0.0374219455, 0.0390345193, -0.0090611279,
                           -0.0229983702, -0.00252604531, 0.0116527639, 0.0234079137, -0.0160617456, 0.028437607,
                           -0.00884995703, -0.00890115, -0.000818685046, 0.00628071837, -0.0222688727, -0.0186597798,
                           -0.0416709483, 0.0262107197, 0.0103793424, 0.0178662911, 0.000158177791, -0.00634790864,
                           0.0113136116, -0.00471613789, -0.00863878708, -0.00790929, 0.00354190264, 0.0328657851,
                           0.0150378887, 0.00765972445, -0.649124861, -0.0212962106, -0.00344591611, 0.00581678329,
                           0.010091383, 0.031457983, 0.00290039275, -0.0261211321, -0.00255484134, 0.0216545593,
                           -0.0267738402, 0.0176231265, 0.0154090365, -0.00180134713, 0.000398144097, -0.0181990452,
                           -0.00324754394, -0.0199779943, -0.0367052481, 0.00155338191, -0.00789649133, 0.0140524274,
                           -0.0231007561, 0.00314355874, 0.0181990452, -0.0153706418, 0.016842436, -0.0187493674,
                           -0.00259003625, 0.0328657851, -0.0245085582, 0.0315091759, 0.0222432762, -0.0169448201,
                           0.0415685624, -0.00174055563, -0.00659747375, 0.0249948911, -0.0031163625, 0.029947795,
                           -0.0126190279, -0.0186213851, 0.00780690368, 0.0232543349, -0.0261467285, -0.0138732521,
                           -0.00822284538, -0.000585917733, -0.0160745438, -0.00723098498, 0.00640230114, -0.0128685934,
                           0.000707900617, 0.00108064828, -0.00622632587, 0.00567920273, 0.0183270276, -0.0108656744,
                           -0.00350030861, 0.0331729427, 0.0182502382, 0.0146923373, -0.0241374113, 0.00843401626,
                           -0.0091699129, 0.0110704461, -0.00662307, 0.00401863595, 0.0186597798, -0.0115951719,
                           0.00823564362, -0.00017577532, -0.01759753, 0.0128941899, 0.0292055, 0.0223968551,
                           -0.00774291297, -0.0253404416, 0.0083380295, -0.0139884362, 0.00778130768, -0.00672545563,
                           -0.0215009805, 0.00306356978, 0.0255324151, -0.00466174539, -0.0242781918, 0.00612394,
                           0.00698142, -0.00971383601, 0.0256220028, 0.00202211598, 0.00374667393, -0.014679539,
                           -0.00700061722, -0.0120111136, -0.024175806, -0.00132221438, 0.0234335102, -0.0161513332,
                           -0.00786449574, -0.00191493111, 0.0173159689, 0.00642469805, 0.0258139763, 0.00241406099,
                           -0.0350158848, 0.000258363725, 0.0113200108, -0.00624232367, 0.00922110491, 0.00167336501,
                           -0.0205283184, -0.00453056395, -0.00188453542, -0.0329681709, 0.0177127123, 0.00163976976,
                           0.0175463371, -0.0249181017, 0.0194020756, -0.00948986784, 0.0373195596, -0.0253916346,
                           0.00771091739, 0.0311764237, -0.0143083911, 0.000597516133, -0.0216545593, 0.018186247,
                           0.0175463371, -0.0319443159, 0.00159417617, -0.018890148, -0.00133421272, -0.0135788936,
                           0.0368076339, 0.0128110014, 0.00363468961, 0.0150634851, -0.0253532398, -0.00518007251,
                           -0.0330449603, 0.0164840855, 0.018519, 0.00491131051, -0.00390985096, -0.000911072071,
                           0.0335824862, 0.0126382252, -0.0258779675, -0.012305472, 0.000201471717, 0.00617513293,
                           0.0351438671, -0.0113456072, 0.00482812198, -0.00500409724, -0.0137708662, -0.0124462526,
                           0.00466174539, 0.000203871372, -0.0271321908, 0.00478332862, 0.0101681724, -0.0255708098,
                           -0.0100209927, 0.0396488346, -0.0128238, -0.0361421257, -0.0120303109, 0.00614313735,
                           -0.00636710599, -0.0218593311, -0.00896514114, 0.0149355028, 0.0054232385, -0.0145771531,
                           -0.020182766, -0.0161641315, 0.0136428848, 0.00911872, -0.0118959295, -0.000902273343,
                           0.0152426595, 0.0003959444, 0.0191205163, 0.00590317138, -0.026389895, 0.0147947231,
                           -0.00744215492, 0.0180710629, -0.0195812508, 0.014730732, 0.000524726347, -0.025417231,
                           0.0163177084, -0.0050072968, 0.0184294134, 0.0405959, -0.00185413973, -0.00998259801,
                           0.0163944978, 0.00684063975, 0.00894594379, -0.0571311787, -0.0171367936, -0.0100977821,
                           0.00970103778, 0.0328913815, -0.00960505102, -0.00795408338, -0.0147435302, -0.00590317138,
                           0.0306388978, 0.0421572812, -0.00613993779, 0.011441594, -0.00360909337, -0.00629671616,
                           0.0115887728, -0.00300437817, -0.00526006147, -0.00165416778, 0.020451529, 0.0274905395,
                           0.0212578159, 0.0411334261, 0.00366028608, -0.0114031993, -0.039290484, -0.00306516956,
                           0.0133485263, 0.00333393202, -0.0045657591, -0.00892674644, 0.0236510802, -0.0152554577,
                           0.0305109154, 0.00427459972, -0.00932989, 0.0100401901, 0.0133357281, -0.0228063986,
                           0.0153450454, 0.00956665725, 0.0205795113, 0.00686623575, -0.0109808585, 0.0104049388,
                           -0.03140679, 0.00656547816, -0.00290359231, -0.0185573939, 0.00698781898, -0.0272601731,
                           -0.000237166707, 0.00110144541, 0.0306388978, 0.0347855166, 0.00684063975, 0.0121646924,
                           -0.000294958591, -0.00874117296, 0.00751894433, 0.0162025243, 0.0127662076, -0.00329873688,
                           0.00762132974, -0.00865798444, -0.0175847318, 0.000838282285, 0.00384266046, -0.037038,
                           0.0220385063, 0.00383306178, -0.00327474019, 0.000934268814, 0.00315315719, 0.0172263812,
                           -0.0115951719, -0.0335312933, 0.014193207, 0.0254300293, -0.00950906519, -0.0150890816,
                           -0.0417477377, -0.00438018516, -0.00613033911, 0.0244573653, 0.025634801, 0.0151914675,
                           0.00482812198, 0.000479532668, -0.00840202067, 0.0143339876, 0.0315091759, -0.0128621943,
                           0.0245853476, -0.000579518615, -0.00827403832, -0.0102961548, -0.020400336, 0.00401863595,
                           -0.00254684244, -0.00721178763, -0.00972023513, -0.0119023286, -0.0128877908, 0.00855559856,
                           -0.033992026, 0.0059351665, -0.0148843098, -0.0158057809, -0.0288471505, -0.00443777675,
                           -0.0196580403, -0.0118255401, 0.048684366, -0.00693662604, -0.00306996889, -0.0140268309,
                           -0.0127598085, -0.00368588255, 0.0733081102, 0.0000586917595, -0.0156266056, -0.00314515852,
                           0.0147563284, -0.0139628397, -0.0152554577, -0.0131053599, 0.0141164176, -0.00454656174,
                           -0.0200931784, 0.0144491717, 0.0182118434, 0.00548722968, 0.00546483276, -0.0028492,
                           -0.0162025243, -0.0108848717, -0.000244165713, 0.0127598085, 0.0109168673, -0.00445057498,
                           0.0347343236, 0.00595436385, -0.00477053039, 0.00788369309, 0.0288983434, 0.0205283184,
                           0.000753094268, -0.0173543636, -0.00399303949, 0.020989053, 0.00211810251, -0.0163561031,
                           -0.0255708098, 0.0139116468, -0.00307316845, 0.0253404416, 0.00643749628, -0.0351182707,
                           0.00964344572, 0.0350926742, -0.00850440562, -0.0151018798, 0.00788369309, -0.0284888,
                           -0.0174951442, 0.018455008, 0.0111216381, -0.00628071837, 0.0436930656, 0.00399623904,
                           -0.013220544, -0.0147691267, -0.00192293, 0.03140679, -0.0358605646, -0.0095986519,
                           -0.0133485263, -0.0163305067, -0.00184774061, -0.0236766767, 0.00552562438, -0.00187653652,
                           -0.01046893, -0.0317651406, -0.0324050486, -0.000643109728, -0.0124334544, 0.021692954,
                           -0.00982262101, -0.00395144522, -0.0335824862, -0.0105457194, -0.00244605658, 0.00918911,
                           0.00708380528, -0.0159977544, -0.00938748196, 0.0432323292, -0.00708380528, -0.0360397398,
                           -0.000791488856, -0.00208610715, -0.0181990452, 0.0206946936, 0.000543123751, -0.00694302516,
                           0.00206211046, 0.00315635675, 0.0299989879, -0.00769172, 0.0383946076, 0.00555122038,
                           0.0184294134, -0.00191493111, -0.00132221438, -0.0235614926, -0.00509048533, -0.00234687049,
                           0.0211170353, -0.0319187194, -0.0406470932, -0.0257499851, -0.00258843647, 0.00204451289,
                           0.0197220314, 0.0341200083, -0.0301525667, -0.00506808842, 0.0160361491, -0.0139884362,
                           0.0401351638, -0.0115311807, 0.0188005604, 0.018186247, -0.0233823173, 0.0391625,
                           0.000633511052, 0.00130701647, -0.00927869696, -0.0231135543, 0.0218977258, 0.0371403843,
                           0.00952186342, -0.0000691402893, 0.0168040413, -0.000437138631, -0.00989941, -0.0112496205,
                           0.011224024, 0.0099761989, -0.0105329212, -0.0551858507, -0.0269530155, -0.00457535777,
                           0.0188261569, 0.0221920852, 0.00400263816, -0.00934908725, -0.0513975844, -0.00404743152,
                           0.00159097661, -0.0102129662, -0.0105457194, -0.0278232936, -0.0207330883, -0.0100401901,
                           -0.0186469816, 0.0155242207, -0.0282328352, 0.00976502895, -0.0274905395, -0.00551282614,
                           0.00111424353, -0.0388041511, -0.0200547837, -0.0146923373, 0.0225888286, 0.0365516692,
                           -0.00145899516, 0.00953466166, 0.0122798756, -0.00588077446, -0.0050072968, 0.00680864416,
                           0.0000983861901, 0.0182630364, -0.0109296655, 0.0287447646, 0.00955385901, 0.00953466166,
                           0.0107760867, 0.0190181304, -0.0000764892611, 0.00910592172, 0.0102385627, -0.00606314884,
                           -0.0277721, -0.00351950596, 0.0208610706, 0.00447937101, -0.00128541957, 0.00630631438,
                           0.0311764237, -0.00134061172, 0.00220609037, -0.020016389, 0.0157417897, 0.00906752702,
                           0.033736065, -0.00957945548, -0.00722458586, -0.0187109727, 0.0196196456, -0.00571119832,
                           -0.0151402745, 0.0130925616, -0.00210530451, 0.000509128498, -0.00344911567, 0.0460735299,
                           -0.0275673289, -0.00418181298, 0.0127662076, 0.00815885421, -0.00715419557, -0.0230879579,
                           0.015434633, -0.0346575342, -0.0109424638, -0.00992500689, -0.0345039554, -0.0375499278,
                           0.00392264919, 0.000382146332, -0.0253020469, 0.0233311243, -0.0088755535, -0.0191333145,
                           0.0159593597, 0.0170856, 0.0100721857, -0.00917631201, 0.00326994085, 0.0170216095,
                           -0.00153578434, -0.0095858546, 0.00400263816, -0.0111472346, -0.00360909337, 0.00260123471,
                           0.0225888286, -0.0303061455, 0.0107440911, 0.00756373815, -0.0134253148, -0.0201955643,
                           -0.0203107484, 0.0206051078, 0.0194148738, 0.0064119, -0.00971383601, 0.00486011757,
                           -0.0214497875, 0.014948301, -0.0183398258, -0.00349710905, -0.03140679, -0.0241374113,
                           -0.0170856, 0.0348879024, -0.0249564964, 0.00962424837, -0.00945787225, -0.0098546166,
                           0.00626792, -0.00652708346, -0.00285399938, -0.00744215492, -0.00430979487, 0.0249948911,
                           -0.000644709507, 0.0132333422, 0.00922110491, -0.0101937689, -0.00979062542, -0.00913151819,
                           -0.0163944978, 0.0267226472, -0.00732057216, 0.012145495, -0.027464943, 0.00274041528,
                           0.0258011781, 0.00419781078, -0.0167016555, -0.00335312914, -0.0123182703, -0.00822284538,
                           0.00801807456, 0.0103025539, 0.00378826819, -0.00528565794, -0.0228959862, 0.00512888,
                           0.00148699118, 0.00867718179, -0.000609114475, -0.0071222, -0.00611434132, -0.00516727474,
                           0.0178918876, 0.0144875655, 0.00186213851, -0.00184454105, 0.00700061722, 0.0311252307,
                           0.00568880141, 0.0155882118, -0.0164968837, 0.00230367668, -0.0227424074, 0.00713499822,
                           0.025685994, -0.0282840282, 0.00782610103, -0.0040794271, -0.0294614639, -0.00761493109,
                           -0.00730777392, 0.0135149024, -0.00520886853, 0.00603435282, 0.00987381395, 0.0158825703,
                           0.0278488901, -0.0268250331, -0.00653668214, 0.0178662911, -0.0185317975, 0.020451529,
                           -0.00329553732, 0.0106481053, 0.022831995, -0.0224736445, 0.0106609035, -0.000809086428,
                           -0.00931069255, -0.0223840568, -0.00649828743, 0.0300245844, -0.00228127977, -0.00477053039,
                           -0.0166888572, -0.0158185791, -0.0119983153, 0.0244701635, -0.0105009256, 0.00154778268,
                           -0.00650148699, 0.0197604261, -0.0199012067, 0.0117871454, -0.0124334544, 0.00210210495,
                           -0.019696435, 0.00308116735, -0.016842436, -0.024662137, -0.0383434184, 0.0160617456,
                           0.0201699678, -0.0108784726, -0.0184166152, 0.015165871, -0.0376779102, -0.0163944978,
                           -0.022448048, 0.0152170639, -0.00868358091, -0.0109744594, -0.00837002508, 0.0237662625,
                           -0.00187173719, -0.00290519209, -0.0163305067, -0.0204259325, 0.00577198947, -0.00933628902,
                           0.0136428848, -0.00663586846, -0.0175079424, -0.0207970794, 0.0195428561, 0.0125678359,
                           -0.00434499, 0.0188133586, -0.00301237707, 0.00414341828, -0.0167912431, 0.00706460793,
                           0.0240990166, 0.0100721857, 0.0109232664, -0.0142571982, -0.025852371, -0.000473533524,
                           0.00562801, -0.0128941899, 0.00801167544, -0.00470014, -0.0270554014, 0.00191813067,
                           0.00980342366, -0.016138535, -0.00637030555, -0.0376011208, 0.0149355028, 0.0033275329,
                           0.00765332533, 0.026927419, -0.0135021042, -0.0117423516, -0.0198116191, 0.00657187728,
                           -0.0229727738, -0.00399303949, 0.0209122635, 0.003049172, 0.00651428523, -0.000239366389,
                           0.0203107484, -0.0316627547, -0.00582638197, 0.00226688175, -0.00793488603, -0.0194020756,
                           -0.00362509093, -0.00162537175, -0.0156394038, -0.00446017366, -0.0228575915, -0.00107744872,
                           0.00162537175, -0.00302677508, -0.0144235753, 0.00060871453, -0.00735896686, 0.0228063986,
                           -0.0200419854, -0.00585197844, -0.0116399657, 0.00680864416, 0.0299221985, 0.0365772657,
                           0.235282168, 0.00947067048, 0.00186213851, 0.0171751883, 0.0165608749, 0.00389065384,
                           0.0240222272, -0.00724378275, 0.00621352764, 0.0238430519, -0.00784529839, 0.0212962106,
                           -0.0104561318, 0.00247165305, 0.0162153225, 0.0101937689, -0.0260955356, 0.00399303949,
                           -0.00680864416, -0.0220385063, -0.002428459, -0.0059351665, 0.0040794271, 0.0114735886,
                           0.0157417897, 0.0099761989, -0.0219617169, -0.0077877068, 0.00142060057, 0.00803727191,
                           -0.00842761714, -0.0205923095, 0.0127662076, -0.0157929827, 0.00496250344, 0.00338512473,
                           0.00678944681, -0.00771091739, 0.0309972484, 0.00385865825, -0.0257499851, 0.00589677226,
                           -0.00502649415, 0.00324914372, -0.0208610706, 0.0369356126, 0.0013046168, -0.0101617733,
                           0.0170216095, 0.0152426595, -0.0239198413, 0.0210530441, 0.0167144537, 0.0263131056,
                           -0.0181222558, -0.00701341545, 0.0219617169, -0.00223808573, -0.0133741219, -0.00248925062,
                           0.0108720735, 0.0168680325, -0.0252380557, 0.014999494, -0.017917484, 0.0267226472,
                           -0.0102641592, -0.0171879865, 0.010360145, -0.00442817807, -0.0136812795, -0.0261979215,
                           0.00696222251, 0.00247165305, -0.0289239399, -0.0226016268, 0.0102065671, 0.0169576183,
                           0.018723771, 0.0230623614, 0.0156394038, -0.00947707, -0.00010598512, -0.0242269989,
                           0.00001011108, -0.0269786119, -0.00664866669, -0.00973303337, 0.00922110491, -0.00370827946,
                           -0.00466814451, -0.00527605927, 0.00861319061, -0.00300757773, 0.0336848721, 0.0244317707,
                           0.00100625877, 0.0375499278, -0.00338192517, -0.00631591305, -0.0100465892, -0.0392392911,
                           0.0383434184, 0.00741655892, 0.0179814752, 0.0108080823, 0.00157817837, -0.00824844185,
                           0.00583918, -0.0182630364, 0.00184294127, 0.00181254547, -0.0128301987, 0.00529845618,
                           0.0102897556, 0.0199268032, 0.00462015113, -0.00585197844, 0.0173031706, -0.00599595811,
                           0.00463294936, -0.0263387021, 0.0060279537, 0.00158617727, -0.0110000558, -0.0215649717,
                           -0.00469054142, 0.0200035907, -0.0149866957, -0.0305877049, -0.000458335649, 0.00404103287,
                           0.0124526517, -0.00932989, -0.010955262, 0.0235742908, -0.00677664857, -0.0141804088,
                           -0.016676059, 0.0236510802, -0.00945147313, -0.00237886608, 0.00252124597, 0.0167528484,
                           0.00461695157, -0.000263163063, 0.0259675533, 0.0112624187, -0.0188645516, -0.0132077457,
                           -0.0456383936, 0.0202083625, -0.00387465605, 0.00533365132, 0.0241502095, -0.00700701633,
                           -0.0462271087, -0.0365772657, 0.00544563541, -0.00587437535, -0.030869266, -0.00109344651,
                           0.00827403832, -0.00214529876, -0.0215905681, -0.0288471505, -0.162076443, 0.00822284538,
                           0.0212066229, -0.0164072961, -0.0151786692, -0.00943227578, 0.0193252861, -0.0140140327,
                           -0.00841481891, -0.0139116468, 0.0327122062, -0.00686623575, -0.0342223942, -0.0295126569,
                           -0.00579118682, 0.00206531, 0.0125678359, 0.00590957049, -0.000648308953, 0.0368844196,
                           0.0152298622, -0.00846601091, 0.0270809978, -0.0126574226, 0.0174823459, 0.0159721579,
                           0.00596076297, 0.00758933462, -0.0223328639, -0.00738456333, -0.0391369052, -0.0167016555,
                           0.0172775742, 0.0233439226, 0.0304597244, -0.00327314041, 0.000931069255, -0.00892034732,
                           -0.0142571982, 0.023420712, 0.0273369625, 0.0213857982, 0.0183782205, -0.00348111126,
                           -0.0122990729, 0.00365388696, 0.0115951719, -0.00177415088, 0.0069558234, -0.0121774906,
                           0.00374667393, -0.0135021042, 0.00540724071, -0.0136172883, 0.0232543349, 0.017751107,
                           0.0166120678, 0.028872747, 0.011979118, -0.00776211033, -0.00606314884, -0.032533031,
                           0.0153834401, 0.00520566897, -0.00808846392, -0.00818445068, -0.000240566224, 0.036372494,
                           -0.0374219455, 0.00097266346, 0.0035994947, 0.0198500138, 0.00810126215, -0.03227707,
                           0.0166888572, 0.026005948, -0.0379850678, 0.0009430676, 0.00284600048, -0.0163561031,
                           -0.0125166429, 0.0389321335, -0.0240350254, 0.0247517247, 0.0108080823, 0.00899713673,
                           0.0188773498, -0.0274905395, 0.0139884362, 0.00162537175, 0.0179814752, -0.0253788363,
                           -0.0112176249, -0.0292055, 0.00484412, 0.0120751048, 0.0302549526, 0.0173543636,
                           -0.0102705583, -0.00572719611, 0.0198884085, -0.0144491717, -0.00900993496, 0.012842997,
                           0.0172903724, -0.00621352764, 0.0140524274, 0.0292055, 0.0323026665, -0.00511288224,
                           -0.00581998285, 0.00639270246, 0.0276953112, 0.0335568897, 0.00964984484, 0.0176103283,
                           -0.00938748196, -0.00898433849, 0.00242685922, 0.00158617727, 0.0474045426, -0.00842121802,
                           0.00366028608, 0.00808846392, -0.0166248661, -0.00597676076, -0.0771987587, -0.0464830734,
                           0.0164328925, 0.0182886329, -0.0282584317, 0.0110704461, -0.00606314884, 0.0230751596,
                           -0.0323794521, 0.0285655893, 0.00555442, -0.019862812, -0.0328145921, -0.00481532374,
                           0.00567600317, -0.00122382818, -0.018890148, -0.00655907905, -0.0140012344, 0.0108592752,
                           0.000114083981, -0.0141036203, 0.0102065671, -0.00648548966, -0.0073717651, 0.00858759414,
                           -0.026172325, 0.0291031133, 0.010360145, -0.00102625589, -0.0101617733, -0.00580718461,
                           -0.00131741504, -0.0138220591, -0.0131181581, 0.00204771245, -0.00548722968, -0.000554722094,
                           0.0062551219, -0.0189541392, 0.00709660351, 0.00272761704, -0.00344591611, -0.0132461404,
                           -0.00946427137, -0.00256923935, -0.0196836367, 0.0129389837, 0.00522166677, -0.0242397971,
                           -0.0241374113, -0.0173159689, -0.031457983, 0.0204771254, 0.0520374924, -0.0131437546,
                           0.00200611842, 0.0188261569, -0.00922750402, 0.00318995211, -0.0111792302, -0.021910524,
                           -0.00623592455, 0.0375755243, -0.00751254521, 0.00580398506, -0.00714779645, -0.0206818972,
                           0.0256603975, -0.00967544131, 0.0141292159, 0.0463806875, -0.0160361491, 0.0029115912,
                           -0.0310484413, -0.00614633691, -0.0202595554, -0.040851865, 0.021526577, -0.0270298049,
                           -0.0335056968, -0.0222432762, -0.00757013727, -0.023151949, 0.0349135, 0.00312436139,
                           0.0121902889, 0.00368588255, -0.00713499822, 0.0016149733, 0.00316435564, 0.0158313774,
                           0.0108272796, -0.0384202041, -0.0197220314, 0.0114159975, -0.00316435564, 0.00553522306,
                           0.0259419587, -0.00645989319, -0.00265562721, -0.0127150146, -0.0270554014, 0.0179046858,
                           -0.0107696876, -0.00454656174, 0.0328401886, -0.0189285427, 0.00855559856, -0.0302805491,
                           -0.0295126569, -0.00204611267, -0.0135916919, -0.00882436149, -0.0135916919, 0.000620712875,
                           -0.0167656466, -0.0177767035, 0.0210146494, -0.00464894716, 0.00653668214, 0.0120431092,
                           0.0144235753, 0.00996340159, 0.0284120105, -0.0013950041, 0.00899713673, 0.0313555971,
                           -0.0251356717, 0.00319795101, -0.035451021, -0.0103665441, -0.00560881244, -0.020989053,
                           0.0270554014, 0.0301013738, -0.0182118434, -0.039290484, 0.0157417897, 0.048940327,
                           -0.0163049102, 0.00986741483, 0.000261763256, -0.0211170353, 0.0165992696, -0.00951546431,
                           0.0145259602, 0.00608554576, -0.0332241356, -0.0129325846, 0.0291543063, 0.0042841984,
                           0.0260827374, 0.0132461404, -0.000503929274, -0.0139628397, -0.0323026665, -0.0349902883,
                           0.0274393484, 0.00187653652, 0.00490811095, -0.0200931784, 0.0249309, -0.00118623348,
                           -0.00309076603, -0.0378826819, 0.00163817, 0.0229471773, -0.0051544765, -0.020451529,
                           0.0208994653, -0.0570799857, -0.0229983702, -0.00740376068, 0.0156777985, 0.0142955929,
                           0.0287703611, 0.0295126569, -0.00288439495, -0.00702621369, -0.0257499851, 0.0456383936,
                           0.0127022164, -0.0330961533, 0.00866438355, -0.00142220035, 0.0195300579, 0.0212706141,
                           -0.0172903724, -0.00290679187, 0.00346831302, 0.00151418743, -0.0277209077, -0.000876676932,
                           0.0157929827, 0.01224788, 0.0251612682, 0.00960505102, 0.0138988486, 0.00830603391,
                           0.00977782719, 0.0455104113, -0.0078516975, -0.00125102431, -0.03140679, -0.0190181304,
                           -0.00138620543, 0.0000931369214, -0.0167912431, -0.00744855404, -0.0148587134, 0.0335568897,
                           0.0354766175, 0.00225088396, 0.0201187748, 0.0127726067, -0.0131309563, -0.0000475933193,
                           -0.00520886853, -0.000629511604, -0.0234463084, 0.0388041511, 0.00788369309, -0.00760213286,
                           0.0001687763, -0.0209122635, 0.0208738688, 0.0128749926, 0.0207970794, -0.0202723537,
                           0.0016973617, 0.0144875655, 0.00404423196, -0.0045497613, -0.000074389558, -0.0229471773,
                           -0.0332753286, -0.0158057809, -0.0197604261, 0.0391113088, -0.00841481891, 0.0461247228,
                           -0.000799487752, 0.00513527915, -0.0141420141, 0.0161513332, -0.000959065335, 0.0249053035,
                           0.00680864416, -0.000296158425, 0.020182766, 0.0239326395, -0.00558001641, -0.00370508,
                           -0.0234463084, -0.0188389551, -0.00163577031, -0.00989941, -0.00995700248, 0.0075061461,
                           -0.0092595, 0.0393928699, 0.000190173305, 0.00484731933, -0.0101041812, -0.00630951393,
                           -0.0161257368, 0.0287191682, -0.0216801558, 0.0124334544, -0.0255836081, -0.0049817008,
                           -0.00915071554, -0.0160489473, -0.0158057809, 0.0201059766, -0.016893629, -0.0173543636,
                           0.00297078281, -0.0068214424, 0.00370508, -0.00271321903, 0.00653348258, -0.00268282322,
                           0.0163817, 0.0299733914, -0.00366348564, -0.00680224504, 0.00726298, -0.0361933187])
l_time = datetime.now()
print(data)

print(f"Time taken to initialize: {l_time - m_time}")
print(f"Time taken to process: {l_time - f_time}")


def search_similar(query: str,
                   top_k: int = 4):

    embedding = OpenAIEmbeddings()
    t0 = datetime.now()
    vector = embedding.embed_query(query)
    t1 = datetime.now()
    data = index.query(
        top_k=top_k,
        include_metadata=True,
        vector=vector
    )
    similar_results = []
    for d in data['matches']:
        try:
            if "metadata" in d:
                similar_results.append(d['metadata']['text'])
                pass
        except Exception as e:
            print("Error occcured while fetching the data:" + str(e))
    t2 = datetime.now()
    print(f"t1 - t0: {t1 - t0}")
    print(f"t2 - t1: {t2 - t1}")
    return similar_results


print(search_similar(query="What happened in playground"))